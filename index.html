<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå¾ˆä¹…äº†å—ï¼Ÿæƒ³åƒæ±è¥¿å—ï¼Ÿä¾†é»é‹å‹•é»å¿ƒå§!</title>
    
    <!-- 1. å¼•å…¥ Tailwind CSS (æ¨£å¼) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. å¼•å…¥ React å’Œ ReactDOM (æ ¸å¿ƒ) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- 3. å¼•å…¥ Babel (ç·¨è­¯å™¨) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-in { animation: fadeIn 0.5s ease-out forwards; }
        
        @keyframes slideInRight { from { transform: translateX(20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .slide-in-from-right { animation: slideInRight 0.3s ease-out forwards; }

        @keyframes slideInBottom { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .slide-in-from-bottom { animation: slideInBottom 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-yellow-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- å…§å»ºåœ–ç¤ºå…ƒä»¶ ---
        const IconBase = ({ children, size = 24, className = "", ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className} 
                {...props}
            >
                {children}
            </svg>
        );

        const Icons = {
            Cookie: (props) => <IconBase {...props}><path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"/><path d="M8.5 8.5v.01"/><path d="M16 15.5v.01"/><path d="M12 12v.01"/><path d="M11 17v.01"/><path d="M7 14v.01"/></IconBase>,
            History: (props) => <IconBase {...props}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/><path d="M12 7v5l4 2"/></IconBase>,
            Lightbulb: (props) => <IconBase {...props}><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></IconBase>,
            Activity: (props) => <IconBase {...props}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></IconBase>,
            Flame: (props) => <IconBase {...props}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-2.246-3.69-2.246-3.69a10 10 0 1 0 5.432 7.72C12.392 12.012 11.668 11.026 11 10c-.575-.92-1.378-2.29-1.378-2.29s1.378 1.37 1.378 2.29c.668 1.026 1.392 2.012 2.186 3.03a10.004 10.004 0 0 0 5.432-7.72c0 0-1.174 1.547-2.246 3.69-.5 1-1 1.62-1 3a2.5 2.5 0 0 0 2.5 2.5z"/></IconBase>,
            Brain: (props) => <IconBase {...props}><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></IconBase>,
            Briefcase: (props) => <IconBase {...props}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></IconBase>,
            Home: (props) => <IconBase {...props}><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></IconBase>,
            Sparkles: (props) => <IconBase {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 5H5"/><path d="M19 19v2"/><path d="M21 21h-2"/></IconBase>,
            ChevronRight: (props) => <IconBase {...props}><path d="m9 18 6-6-6-6"/></IconBase>,
            ArrowLeft: (props) => <IconBase {...props}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></IconBase>,
            Clock: (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></IconBase>,
            Timer: (props) => <IconBase {...props}><line x1="10" x2="14" y1="2" y2="2"/><line x1="12" x2="15" y1="14" y2="11"/><circle cx="12" cy="14" r="8"/></IconBase>,
            CheckCircle: (props) => <IconBase {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>,
            RotateCcw: (props) => <IconBase {...props}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/></IconBase>,
            Trophy: (props) => <IconBase {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></IconBase>,
            Calendar: (props) => <IconBase {...props}><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></IconBase>,
            BookOpen: (props) => <IconBase {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>,
            Gamepad2: (props) => <IconBase {...props}><line x1="6" x2="10" y1="12" y2="12"/><line x1="8" x2="8" y1="10" y2="14"/><line x1="15" x2="15.01" y1="13" y2="13"/><line x1="18" x2="18.01" y1="11" y2="11"/><rect width="20" height="12" x="2" y="6" rx="2"/></IconBase>,
            Shirt: (props) => <IconBase {...props}><path d="M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z"/></IconBase>,
        };

        const { 
            Cookie, History, Lightbulb, Activity, Flame, Brain, Briefcase, Home, Sparkles, 
            ChevronRight, ArrowLeft, Clock, Timer, CheckCircle, RotateCcw, Trophy, Calendar,
            BookOpen, Gamepad2, Shirt
        } = Icons;

        // --- è³‡æ–™åº«è¨­å®š (åœ‹ä¸­ç”Ÿç‰ˆæœ¬) ---
        const SNACK_BENEFITS = [
            "å‹• 20 ç§’å°±èƒ½è®“å¤§è…¦è¦ºé†’ï¼Œç­‰ç­‰è€ƒè©¦çŒœé¡Œéƒ½çŒœå°ï¼ˆèª¤ï¼‰ã€‚",
            "åå¤ªä¹…å±è‚¡æœƒè®Šå¤§ï¼Œèµ·ä¾†å‹•ä¸€ä¸‹æ•‘æ•‘ä½ çš„è‡€å‹ã€‚",
            "é€™æ¯”å–æ‰‹æ–æ¯é‚„èƒ½è®“ä½ å¿ƒæƒ…å¥½ï¼Œè€Œä¸”æ˜¯å…è²»çš„ã€‚",
            "åˆ¥å†æ»‘æ‰‹æ©Ÿäº†ï¼Œè®“çœ¼ç›ä¼‘æ¯ä¸€ä¸‹ï¼Œé †ä¾¿ç·´å€‹ç·šæ¢ã€‚",
            "ä½ çŸ¥é“å—ï¼Ÿè‚Œè‚‰é‡å¤šçš„äººï¼Œèººè‘—ä¸å‹•ç‡ƒç‡’çš„ç†±é‡ä¹Ÿæ¯”è¼ƒå¤šã€‚",
            "ç¾åœ¨å‹•ä¸€å‹•ï¼Œç­‰ç­‰åˆä¼‘è¶´è‘—ç¡æ‰ä¸æœƒè…³éº»ã€‚",
            "è€å¸«èªªè¦ã€Œå‹•ã€è…¦ï¼Œä½†æ²’èªªèº«é«”ä¸èƒ½å‹•å•Šï¼",
            "ç·´å¥½é«”åŠ›ï¼Œä¸ç®¡æ˜¯æ‰“çƒé‚„æ˜¯æ¶ç¦åˆ©ç¤¾éºµåŒ…éƒ½è´åœ¨èµ·è·‘é»ã€‚"
        ];

        const MODES = {
            OFFICE: { 
                id: 'office', 
                label: 'å­¸æ ¡/è£œç¿’ç­', 
                icon: <BookOpen size={24} />, 
                desc: 'è€å¸«åœ¨çœ‹ï¼Œä½èª¿ç·´åŠŸ', 
                color: 'text-blue-600 bg-blue-50 border-blue-100 hover:border-blue-300',
                theme: 'blue'
            },
            HOME: { 
                id: 'home', 
                label: 'åœ¨å®¶ç‹‚æš´æ¨¡å¼', 
                icon: <Gamepad2 size={24} />, 
                desc: 'æ²’äººçœ‹ï¼Œç›´æ¥é–‹å¤§çµ•', 
                color: 'text-red-600 bg-red-50 border-red-100 hover:border-red-300',
                theme: 'orange'
            },
            FORMAL: { 
                id: 'formal', 
                label: 'ç©¿åˆ¶æœ/è£™å­', 
                icon: <Shirt size={24} />, 
                desc: 'å‹•ä½œå°ä¸€é»ï¼Œé¿å…å°·å°¬', 
                color: 'text-purple-600 bg-purple-50 border-purple-100 hover:border-purple-300',
                theme: 'purple'
            }
        };

        const EXERCISE_DB = [
            { 
                id: 'b3', type: 'B', title: 'ä¸Šèª²å·ç·´å°è…¿', rarity: 'N',
                desc: 'åè‘—æˆ–ç«™è‘—éƒ½å¯ä»¥ï¼Œè…³è·Ÿåè¦†æèµ·ä¾†ã€æ”¾ä¸‹å»ã€‚', 
                modes: ['office', 'formal', 'home'],
                coach_say: 'è€å¸«ä»¥ç‚ºä½ åœ¨ç™¼å‘†ï¼Œå…¶å¯¦ä½ åœ¨ç·´ç¥è…¿ï¼',
                science: 'é€™æ˜¯ä½ çš„ã€Œç¬¬äºŒé¡†å¿ƒè‡Ÿã€ï¼Œå¹«ä½ æŠŠè¡€æ¶²æ‰“å›å¿ƒè‡Ÿï¼Œè…³æ¯”è¼ƒä¸æœƒè…«ã€‚',
                duration: 60 
            },
            { 
                id: 'c3', type: 'C', title: 'é›™æ‰‹ç•«åœˆåœˆ', rarity: 'N',
                desc: 'é›™æ‰‹å¹³èˆ‰ï¼Œåƒèºçµ²èµ·å­ä¸€æ¨£è½‰åœˆåœˆï¼Œæ­£è½‰åè½‰éƒ½è¦ã€‚', 
                modes: ['office', 'formal', 'home'],
                coach_say: 'å¯«è€ƒå·å¯«åˆ°æ‰‹æ–·æ‰ï¼Ÿè½‰ä¸€ä¸‹å•¦ï¼Œè¶…çˆ½çš„ï¼',
                science: 'è®“è‚©è†€é—œç¯€å‹•ä¸€å‹•ï¼Œé é˜²ä»¥å¾Œè®Šæˆäº”åè‚©ï¼ˆé›–ç„¶ä½ é‚„æ—©ï¼‰ã€‚',
                duration: 60 
            },
            { 
                id: 'c9', type: 'C', title: 'ä¸ç®¡æˆ‘ä¹Ÿæ²’å·®', rarity: 'N',
                desc: 'è‚©è†€ç”¨åŠ›è³èµ·ä¾†æ‰¾è€³æœµï¼Œåœ3ç§’ï¼Œç„¶å¾Œç¬é–“æ”¾é¬†ã€‚', 
                modes: ['office', 'formal', 'home'],
                coach_say: 'æŠŠæ®µè€ƒå£“åŠ›å…¨éƒ¨ä¸Ÿåˆ°åœ°æ¿ä¸Šï¼èª°ç®¡ä»–å•Šï¼',
                science: 'é€™å«ã€Œæ¼¸é€²å¼è‚Œè‚‰æ”¾é¬†ã€ï¼Œèƒ½å¼·åˆ¶è®“ç·Šç¹ƒçš„è‚©è†€é¬†é–‹ã€‚',
                duration: 60 
            },
            { 
                id: 'a8', type: 'A', title: 'åŸåœ°è¶…æ…¢è·‘', rarity: 'N',
                desc: 'åœ¨åŸåœ°å‡è£è·‘æ­¥ï¼Œé€Ÿåº¦æ…¢åˆ°åƒæ˜¯åœ¨æ•£æ­¥ï¼Œä¿æŒå¾®ç¬‘ã€‚', 
                modes: ['office', 'home'],
                coach_say: 'ä¿æŒå¾®ç¬‘ï¼é€™æ˜¯ä¸€ç¨®ä¼‘æ¯ä¹Ÿæ˜¯é‹å‹•ï¼Œå‡è£è‡ªå·±å¾ˆå¿™ã€‚',
                science: 'é€™èƒ½æå‡ç´°èƒé‹ç”¨æ°§æ°£çš„èƒ½åŠ›ï¼Œè®“ä½ é«”åŠ›è®Šå¥½åˆä¸å‚·è†è“‹ã€‚',
                duration: 60 
            },
            { 
                id: 'a9', type: 'A', title: 'è†ä¸‹æ“ŠæŒ', rarity: 'R',
                desc: 'æŠ¬é«˜ä¸€è…³è†è“‹ï¼Œé›™æ‰‹åœ¨è©²è†è“‹ä¸‹æ–¹æ‹æ‰‹ï¼Œå·¦å³è¼ªæµã€‚', 
                modes: ['home'], 
                coach_say: 'è…¿æŠ¬é«˜ï¼ç”¨åŠ›æ‹ä¸‹å»ï¼åƒå€‹éå‹•å…’ä¸€æ¨£å‹•èµ·ä¾†ï¼',
                science: 'çµåˆæŠ¬è…¿è·Ÿæ ¸å¿ƒç”¨åŠ›ï¼Œå¿ƒè·³æœƒè®Šå¿«ï¼Œç²¾ç¥æœƒè®Šå¥½ã€‚',
                duration: 60 
            },
            { 
                id: 'b11', type: 'B', title: 'å¼“ç®­æ­¥è¹²', rarity: 'SR',
                desc: 'ä¸€è…³å‰ä¸€è…³å¾Œï¼Œèº«é«”å‚ç›´è¹²ä¸‹å»ï¼Œå¾Œè…³è†è“‹å¿«ç¢°åˆ°åœ°å†èµ·ä¾†ã€‚', 
                modes: ['office', 'home'],
                coach_say: 'ç·´å¤§è…¿ç·šæ¢ç”¨çš„ï¼Œç©¿çŸ­è¤²/çŸ­è£™æœƒå¾ˆå¥½çœ‹å–”ï¼',
                science: 'è¨“ç·´å¹³è¡¡æ„Ÿè·Ÿå¤§è…¿åŠ›é‡ï¼Œè®“ä½ ç«™å¾—æ›´ç©©ã€‚',
                duration: 60 
            },
            { 
                id: 'a1', type: 'A', title: 'æ¨“æ¢¯è¡åˆº', rarity: 'SR',
                desc: 'å…¨é€Ÿè¡åˆºçˆ¬æ¨“æ¢¯ï¼ˆç´„3å±¤æ¨“ï¼‰ï¼Œå°å¿ƒä¸è¦è·Œå€’ã€‚', 
                modes: ['office', 'home'],
                coach_say: 'æ‹¿å‡ºä½ å»ç¦åˆ©ç¤¾æ¶éºµåŒ…çš„é€Ÿåº¦ï¼è¡å•Šï¼',
                science: 'é€™æ˜¯æ•ˆç‡æœ€é«˜çš„é‹å‹•ä¹‹ä¸€ï¼Œåšä¸€ä¸‹æŠµéæ…¢è·‘å¥½å¹¾åˆ†é˜ã€‚',
                duration: 60 
            },
            { 
                id: 'a5', type: 'A', title: 'åœ°ç„æ³¢æ¯”è·³', rarity: 'SR',
                desc: 'è¹²ä¸‹ -> å¾€å¾Œè¸¢ -> æ”¶è…¿ -> è·³èµ·ä¾†ã€‚', 
                modes: ['home'], 
                coach_say: 'é€™å€‹çœŸçš„å¾ˆç´¯ï¼Œåšå®Œæœƒå‡å¤©ï¼Œä½†æ˜¯ç‡ƒè„‚æ•ˆæœæœ€é ‚ï¼',
                science: 'å…¨èº«éƒ½åœ¨å‹•ï¼Œé‹å‹•å®Œå¾Œèº«é«”é‚„æœƒæŒçºŒç‡ƒç‡’ç†±é‡ï¼ˆå¾Œç‡ƒæ•ˆæ‡‰ï¼‰ã€‚',
                duration: 60 
            },
            { 
                id: 'b1', type: 'B', title: 'æ¡Œé‚Šä¼åœ°æŒºèº«', rarity: 'R',
                desc: 'æ‰‹æ’è‘—æ¡Œå­é‚Šç·£ï¼ˆç¢ºèªæ¡Œå­ä¸æœƒå‹•ï¼‰ï¼Œèº«é«”å‘ˆç›´ç·šåšä¼åœ°æŒºèº«ã€‚', 
                modes: ['office', 'home'],
                coach_say: 'æ ¸å¿ƒæ”¶ç·Šï¼ç·´ä¸€ä¸‹èƒ¸è‚Œ/æ‰‹è‡‚ï¼Œçœ‹èµ·ä¾†æ¯”è¼ƒå£¯/çµå¯¦ã€‚',
                science: 'ä¸ç”¨è¶´åœ¨åœ°æ¿ä¸Šä¹Ÿèƒ½ç·´åˆ°ä¸ŠåŠèº«çš„åŠ›é‡ã€‚',
                duration: 60 
            },
            { 
                id: 'b2', type: 'B', title: 'æ·±è¹²æ•‘å±è‚¡', rarity: 'N',
                desc: 'é›™è…³æ‰“é–‹èˆ‡è‚©åŒå¯¬ï¼Œå±è‚¡å‘å¾Œåï¼Œè†è“‹ä¸è¦å…§å¤¾ã€‚', 
                modes: ['office', 'home'],
                coach_say: 'åå¤ªä¹…å±è‚¡æœƒæ‰æ‰ï¼Œå¿«é»è¹²ä¸€ä¸‹æ•‘å›ä¾†ï¼',
                science: 'è…¿éƒ¨è‚ŒåŠ›ä¹‹ç‹ï¼Œèƒ½ä¿ƒé€²ç”Ÿé•·æ¿€ç´ åˆ†æ³Œï¼ˆå¯èƒ½æœƒé•·é«˜å–”ï¼‰ã€‚',
                duration: 60 
            },
            { 
                id: 'b10', type: 'B', title: 'æ’æ¡Œæ£’å¼', rarity: 'R',
                desc: 'æ‰‹è‚˜æ’åœ¨æ¡Œä¸Šï¼Œèº«é«”æŒºç›´ï¼Œè‚šå­ç”¨åŠ›ç¸®é€²å»ï¼Œæ’ä½ä¸å‹•ã€‚', 
                modes: ['office', 'home'],
                coach_say: 'å¿ä½ï¼è‚šå­åœ¨ç™¼æŠ–æ˜¯æ­£å¸¸çš„ï¼Œé‚£æ˜¯è‚¥è‚‰åœ¨å°–å«ï¼',
                science: 'è¨“ç·´æ·±å±¤æ ¸å¿ƒè‚Œç¾¤ï¼Œè®“ä½ çš„è…°æ¯”è¼ƒä¸æœƒç— ã€‚',
                duration: 60 
            },
            { 
                id: 'c1', type: 'C', title: 'ç©ºæ°£æ¤…å­', rarity: 'SR',
                desc: 'èƒŒé ç‰†å£ï¼Œå¤§è…¿è·Ÿåœ°æ¿å¹³è¡Œï¼Œå‡è£æœ‰åæ¤…å­ï¼Œæ’ä½ï¼', 
                modes: ['office', 'formal', 'home'],
                coach_say: 'é€™æ˜¯ç½°ç«™é€²éšç‰ˆï¼Œå¤§è…¿æœƒé…¸åˆ°çˆ†ï¼Œæ’ä½å•Šï¼',
                science: 'é€™èƒ½å¹«å¿™æŠŠè¡€æ¶²è£¡çš„ç³–åˆ†æŠ“é€²è‚Œè‚‰è£¡ï¼Œæ‰ä¸æœƒåƒé£½æƒ³ç¡è¦ºã€‚',
                duration: 60 
            },
            { 
                id: 'c8', type: 'C', title: 'åå§¿è½‰è½‰è…°', rarity: 'N',
                desc: 'ååœ¨æ¤…å­ä¸Šï¼Œé›™æ‰‹æŠ±èƒ¸ï¼Œä¸ŠåŠèº«å·¦å³è½‰åˆ°åº•ã€‚', 
                modes: ['office', 'formal', 'home'],
                coach_say: 'è½‰ä¸€è½‰ï¼Œé †ä¾¿çœ‹çœ‹å¾Œé¢çš„åŒå­¸åœ¨å¹¹å˜›ï¼ˆèª¤ï¼‰ã€‚',
                science: 'ä¹…åæœ€å‚·è„Šæ¤ï¼Œè½‰ä¸€è½‰å¯ä»¥é‡‹æ”¾è…°éƒ¨çš„å£“åŠ›ã€‚',
                duration: 60 
            },
        ];

        // --- å…ƒä»¶ ---

        const DurationBtn = ({ min, onClick, themeColor }) => {
            const colors = {
                blue: { bg: 'bg-blue-50', text: 'text-blue-600', border: 'hover:border-blue-500', badge: 'bg-blue-100' },
                orange: { bg: 'bg-orange-50', text: 'text-orange-600', border: 'hover:border-orange-500', badge: 'bg-orange-100' },
                purple: { bg: 'bg-purple-50', text: 'text-purple-600', border: 'hover:border-purple-500', badge: 'bg-purple-100' },
                default: { bg: 'bg-indigo-50', text: 'text-indigo-600', border: 'hover:border-indigo-500', badge: 'bg-indigo-100' }
            };
            
            const c = colors[themeColor] || colors.default;

            return (
                <button 
                    onClick={onClick}
                    className={`relative group bg-white p-6 rounded-2xl shadow-md border-2 border-transparent ${c.border} hover:shadow-xl transition-all transform active:scale-95 flex flex-col items-center justify-center gap-2 duration-200`}
                >
                    <div className={`absolute top-0 right-0 ${c.badge} ${c.text} text-xs font-bold px-2 py-1 rounded-bl-xl rounded-tr-xl`}>
                        +{min * 10} XP
                    </div>
                    <div className={`${c.bg} p-4 rounded-full ${c.text} group-hover:scale-110 transition-transform duration-300`}>
                        <Timer size={32} />
                    </div>
                    <div className="text-2xl font-black text-gray-800">{min} <span className="text-sm font-medium text-gray-500">åˆ†é˜</span></div>
                    <div className="text-xs text-gray-400 font-medium">{min} å€‹å‹•ä½œ</div>
                </button>
            );
        };

        const ModeBtn = ({ mode, onClick }) => (
            <button 
                onClick={onClick}
                className={`w-full p-5 rounded-2xl shadow-sm border-2 transition-all text-left flex items-center gap-4 group ${mode.color} hover:shadow-md transform active:scale-95 duration-200`}
            >
                <div className="bg-white/80 p-3 rounded-full group-hover:bg-white group-hover:scale-110 transition-all shadow-sm">
                    {mode.icon}
                </div>
                <div>
                    <h3 className="font-bold text-lg">{mode.label}</h3>
                    <p className="text-xs opacity-70 font-medium">{mode.desc}</p>
                </div>
                <div className="ml-auto opacity-0 group-hover:opacity-100 transition-opacity transform group-hover:translate-x-1">
                    <ChevronRight />
                </div>
            </button>
        );

        const HistoryItem = ({ record }) => (
            <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center mb-3">
                <div className="flex items-center gap-3">
                    <div className="bg-green-100 text-green-600 p-2 rounded-lg">
                        <CheckCircle size={20} />
                    </div>
                    <div>
                        <div className="text-sm text-gray-400">{record.date}</div>
                        <div className="font-bold text-gray-800">{record.duration} åˆ†é˜å¥—é¤</div>
                    </div>
                </div>
                <div className="text-right">
                    <div className="text-xs text-gray-400">å®Œæˆ {record.exercises} å€‹å‹•ä½œ</div>
                </div>
            </div>
        );

        function App() {
            const [gameState, setGameState] = useState('dashboard');
            const [userStats, setUserStats] = useState({ streak: 3, focus: 45 });
            const [history, setHistory] = useState([]); 
            const [currentBenefit, setCurrentBenefit] = useState(SNACK_BENEFITS[0]);
            const [selectedMode, setSelectedMode] = useState(null);
            
            const [playlist, setPlaylist] = useState([]);
            const [currentIdx, setCurrentIdx] = useState(0);
            const [timeLeft, setTimeLeft] = useState(0);
            const [isResting, setIsResting] = useState(false); 
            const [timerActive, setTimerActive] = useState(false);

            useEffect(() => {
                if (gameState === 'dashboard') {
                    const randomIndex = Math.floor(Math.random() * SNACK_BENEFITS.length);
                    setCurrentBenefit(SNACK_BENEFITS[randomIndex]);
                }
            }, [gameState]);

            const chooseMode = (modeId) => {
                setSelectedMode(modeId);
                setGameState('select-duration');
            };

            const startWorkout = (minutes) => {
                const pool = EXERCISE_DB.filter(ex => ex.modes.includes(selectedMode));
                let shuffled = [...pool].sort(() => 0.5 - Math.random());
                const selected = [];
                while (selected.length < minutes) {
                    if (shuffled.length === 0) {
                        shuffled = [...pool].sort(() => 0.5 - Math.random());
                    }
                    selected.push(shuffled.pop());
                }
                
                setPlaylist(selected);
                setCurrentIdx(0);
                setGameState('playing');
                setIsResting(false); 
                setTimeLeft(selected[0].duration);
                setTimerActive(true);
            };

            const finishWorkout = () => {
                const totalDuration = playlist.length;
                const focusEarned = totalDuration * 10;

                setUserStats(prev => ({
                    streak: prev.streak, 
                    focus: Math.min(100, prev.focus + focusEarned)
                }));

                const newRecord = {
                    id: Date.now(),
                    date: new Date().toLocaleString('zh-TW', { month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' }),
                    duration: totalDuration,
                    exercises: totalDuration
                };
                setHistory(prev => [newRecord, ...prev]);

                setGameState('result');
                setTimerActive(false);
            };

            const nextExercise = () => {
                if (currentIdx < playlist.length - 1) {
                    setCurrentIdx(prev => prev + 1);
                    setTimeLeft(playlist[currentIdx + 1].duration);
                    setIsResting(false);
                    setTimerActive(true);
                } else {
                    finishWorkout();
                }
            };

            useEffect(() => {
                let interval = null;
                if (timerActive && timeLeft > 0 && !isResting) {
                    interval = setInterval(() => {
                        setTimeLeft((prev) => prev - 1);
                    }, 1000);
                } else if (timeLeft === 0 && timerActive && !isResting) {
                    if (currentIdx < playlist.length - 1) {
                        setIsResting(true);
                        setTimeout(() => {
                            nextExercise();
                        }, 3000); 
                    } else {
                        finishWorkout();
                    }
                }
                return () => clearInterval(interval);
            }, [timerActive, timeLeft, isResting, currentIdx, playlist]);

            // --- è¦–åœ– ---

            if (gameState === 'dashboard') {
                return (
                    <div className="min-h-screen bg-yellow-50 p-4 font-sans max-w-md mx-auto flex flex-col animate-in fade-in duration-500">
                        <header className="mb-6 flex justify-between items-start">
                            <div className="flex-1">
                                <h1 className="text-2xl font-black text-gray-800 flex items-start gap-2 leading-tight">
                                    <Cookie className="text-orange-500 shrink-0 mt-1" /> 
                                    <span>åå¾ˆä¹…äº†å—ï¼Ÿæƒ³åƒæ±è¥¿å—ï¼Ÿ<br/><span className="text-lg font-bold text-gray-500">ä¾†é»é‹å‹•é»å¿ƒå§!</span></span>
                                </h1>
                            </div>
                            <button 
                                onClick={() => setGameState('history')}
                                className="bg-white p-2 rounded-full shadow-sm border border-gray-200 text-gray-600 hover:text-indigo-600 shrink-0 hover:shadow-md transition-all active:scale-90"
                            >
                                <History size={24} />
                            </button>
                        </header>

                        <div className="bg-white p-4 rounded-xl shadow-md border-l-4 border-indigo-500 mb-6 flex gap-3 transform hover:scale-[1.02] transition-transform duration-300">
                            <Lightbulb className="text-indigo-500 shrink-0" />
                            <div>
                                <div className="text-xs font-bold text-indigo-500 mb-1 uppercase tracking-wider">ğŸ’¡ é»å¿ƒå†·çŸ¥è­˜</div>
                                <p className="text-gray-700 text-sm font-medium leading-relaxed">
                                    {currentBenefit}
                                </p>
                            </div>
                        </div>

                        <div className="flex-1">
                            <div className="flex items-center gap-2 mb-4">
                                <Briefcase className="text-orange-600" />
                                <h2 className="text-lg font-bold text-gray-800">ä½ ç¾åœ¨åœ¨å“ªè£¡ï¼Ÿ</h2>
                            </div>
                            <p className="text-gray-500 text-sm mb-6">é¸å°åœ°é»ï¼Œæ‰ä¸æœƒè¢«ç•¶æˆæ€ªäººã€‚</p>
                            
                            <div className="space-y-4">
                                <ModeBtn mode={MODES.OFFICE} onClick={() => chooseMode('office')} />
                                <ModeBtn mode={MODES.HOME} onClick={() => chooseMode('home')} />
                                <ModeBtn mode={MODES.FORMAL} onClick={() => chooseMode('formal')} />
                            </div>
                        </div>
                    </div>
                );
            }

            if (gameState === 'select-duration') {
                const currentMode = MODES[selectedMode?.toUpperCase()];
                const themeColor = currentMode?.theme || 'default';

                return (
                    <div className="min-h-screen bg-yellow-50 p-4 font-sans max-w-md mx-auto flex flex-col animate-in slide-in-from-right duration-300">
                        <header className="mb-6 flex items-center gap-2">
                            <button 
                                onClick={() => setGameState('dashboard')}
                                className="p-2 bg-white rounded-full shadow-sm hover:bg-gray-100 hover:shadow-md transition-all"
                            >
                                <ArrowLeft size={20} className="text-gray-600" />
                            </button>
                            <div className="flex items-center gap-2 text-gray-800">
                                {currentMode?.icon}
                                <h1 className="text-xl font-bold">
                                    {currentMode?.label || 'é¸æ“‡æ™‚é–“'}
                                </h1>
                            </div>
                        </header>

                        <div className="flex-1 flex flex-col justify-center">
                            <div className="text-center mb-8">
                                <div className={`inline-block p-4 rounded-full mb-4 ${
                                    themeColor === 'blue' ? 'bg-blue-100 text-blue-600' :
                                    themeColor === 'orange' ? 'bg-orange-100 text-orange-600' :
                                    themeColor === 'purple' ? 'bg-purple-100 text-purple-600' : 'bg-indigo-100 text-indigo-600'
                                }`}>
                                    <Clock size={40} />
                                </div>
                                <h2 className="text-2xl font-black text-gray-800">è¦å°»å¤šä¹…ï¼Ÿ</h2>
                                <p className="text-gray-500 mt-2">æƒ³ç¨å¾®å‹•ä¸€ä¸‹ï¼Œé‚„æ˜¯å¾¹åº•æ¸…é†’ï¼Ÿ<br/>æ¯å€‹å‹•ä½œ 1 åˆ†é˜ã€‚</p>
                            </div>

                            <div className="grid grid-cols-2 gap-4">
                                <DurationBtn min={1} onClick={() => startWorkout(1)} themeColor={themeColor} />
                                <DurationBtn min={3} onClick={() => startWorkout(3)} themeColor={themeColor} />
                                <DurationBtn min={5} onClick={() => startWorkout(5)} themeColor={themeColor} />
                                <DurationBtn min={10} onClick={() => startWorkout(10)} themeColor={themeColor} />
                            </div>
                        </div>
                    </div>
                );
            }

            if (gameState === 'history') {
                return (
                    <div className="min-h-screen bg-yellow-50 p-4 font-sans max-w-md mx-auto animate-in slide-in-from-bottom duration-300">
                        <header className="mb-6 flex items-center gap-3">
                            <button onClick={() => setGameState('dashboard')} className="p-2 bg-white rounded-full shadow-sm hover:bg-gray-100 transition-all">
                                <RotateCcw size={20} />
                            </button>
                            <h1 className="text-xl font-bold text-gray-800">æˆ°ç¸¾ä¸€è¦½</h1>
                        </header>

                        {history.length === 0 ? (
                            <div className="flex flex-col items-center justify-center h-64 text-gray-400">
                                <Calendar size={48} className="mb-4 opacity-20" />
                                <p>ç›®å‰é‚„æ²’ç´€éŒ„ï¼Œå¿«å»å‹•ä¸€å‹•å•¦ï¼</p>
                            </div>
                        ) : (
                            <div className="space-y-2">
                                {history.map(record => (
                                    <HistoryItem key={record.id} record={record} />
                                ))}
                            </div>
                        )}
                    </div>
                );
            }

            if (gameState === 'playing' && playlist.length > 0) {
                const currentCard = playlist[currentIdx];
                const progress = ((currentCard.duration - timeLeft) / currentCard.duration) * 100;
                const totalProgress = ((currentIdx) / playlist.length) * 100;

                return (
                    <div className="min-h-screen bg-gray-900 flex flex-col font-sans max-w-md mx-auto relative overflow-hidden animate-in fade-in duration-500">
                        <div className="bg-gray-800 p-4 flex justify-between items-center z-10">
                            <div className="text-white text-sm font-bold">
                                é—œå¡ {currentIdx + 1} <span className="text-gray-500">/ {playlist.length}</span>
                            </div>
                            <button onClick={() => setGameState('dashboard')} className="text-gray-500 hover:text-white transition-colors">
                                <RotateCcw size={20} />
                            </button>
                        </div>
                        <div className="w-full h-1 bg-gray-800">
                            <div className="h-full bg-indigo-500 transition-all duration-300" style={{ width: `${totalProgress}%` }}></div>
                        </div>

                        {isResting ? (
                            <div className="flex-1 flex flex-col items-center justify-center text-white animate-in zoom-in duration-300">
                                <h2 className="text-4xl font-black mb-2 text-green-400">æ°´å•¦ï¼æ’ä½äº†ï¼</h2>
                                <p className="text-gray-400 mb-8">ä¸‹ä¸€å€‹æŒ‘æˆ°æº–å‚™ä¸­...</p>
                                <div className="text-xl font-bold">{playlist[currentIdx + 1]?.title}</div>
                                <div className="mt-4 text-3xl font-mono animate-pulse">Ready...</div>
                            </div>
                        ) : (
                            <div className="flex-1 flex flex-col items-center justify-center p-6 text-center relative z-10">
                                <div className={`mb-6 px-3 py-1 rounded-full text-xs font-bold border ${
                                    currentCard.type === 'A' ? 'text-red-400 border-red-400' : 
                                    currentCard.type === 'B' ? 'text-blue-400 border-blue-400' : 'text-green-400 border-green-400'
                                }`}>
                                    {currentCard.type === 'A' ? 'æœ‰æ°§åˆ·å¿ƒç‡' : currentCard.type === 'B' ? 'è‚ŒåŠ›ç·´ç·šæ¢' : 'æ”¾é¬†æ‹‰ç­‹'}
                                </div>

                                <h2 className="text-3xl font-black text-white mb-4 leading-tight">{currentCard.title}</h2>
                                
                                <div className="relative mb-8">
                                    <div className="text-[5rem] font-black font-mono text-white leading-none tabular-nums tracking-tighter">
                                        {timeLeft}
                                    </div>
                                    <div className="text-indigo-400 text-sm font-bold tracking-widest">ç§’</div>
                                </div>

                                <div className="bg-white/10 backdrop-blur-md p-4 rounded-2xl border border-white/10 w-full text-left mb-8 transform transition-all hover:bg-white/20">
                                    <div className="flex items-center gap-2 mb-2">
                                        <div className="w-2 h-2 rounded-full bg-green-400 animate-pulse"></div>
                                        <span className="text-xs text-indigo-300 font-bold uppercase">æ•™ç·´ç¢ç¢å¿µ</span>
                                    </div>
                                    <p className="text-white text-md font-medium">"{currentCard.coach_say}"</p>
                                </div>

                                <div className="flex gap-4 w-full">
                                    <button 
                                        onClick={() => setTimerActive(!timerActive)}
                                        className="flex-1 bg-gray-700 text-white py-4 rounded-xl font-bold hover:bg-gray-600 transition active:scale-95"
                                    >
                                        {timerActive ? 'å·æ‡¶æš«åœ' : 'ç¹¼çºŒæ‹š'}
                                    </button>
                                    <button 
                                        onClick={() => {
                                            setIsResting(true);
                                            setTimeout(() => nextExercise(), 500); 
                                        }}
                                        className="bg-gray-800 text-gray-400 px-6 rounded-xl font-bold hover:bg-gray-700 hover:text-white transition active:scale-95"
                                    >
                                        è·³é
                                    </button>
                                </div>
                                
                                <p className="mt-8 text-gray-800 text-xl font-bold leading-relaxed bg-white/60 p-4 rounded-xl shadow-sm border border-gray-100">{currentCard.desc}</p>
                            </div>
                        )}

                        {!isResting && (
                            <div className="absolute bottom-0 left-0 w-full h-2 bg-gray-800">
                                <div className="h-full bg-green-500 transition-all duration-1000 ease-linear" style={{ width: `${progress}%` }}></div>
                            </div>
                        )}
                    </div>
                );
            }

            if (gameState === 'result') {
                return (
                    <div className="min-h-screen bg-indigo-600 p-6 flex flex-col items-center justify-center max-w-md mx-auto">
                        <div className="bg-white rounded-3xl p-8 shadow-2xl w-full text-center animate-in zoom-in duration-300">
                            
                            <div className="w-20 h-20 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg border-4 border-white animate-bounce">
                                <Trophy size={40} className="text-yellow-900" />
                            </div>

                            <h2 className="text-3xl font-black text-gray-800 mb-2">æå®šå•¦ï¼</h2>
                            <p className="text-gray-500 mb-6">é€™çµ„å¥—é¤åšå®Œï¼Œæ•´å€‹äººéƒ½ç¥æ¸…æ°£çˆ½äº†ã€‚</p>

                            <div className="bg-gray-50 p-6 rounded-2xl mb-6">
                                <div className="text-gray-400 text-sm mb-1">æœ¬æ¬¡é‹å‹•æ™‚é–“</div>
                                <div className="text-4xl font-black text-gray-800">{playlist.length} <span className="text-lg text-gray-500">åˆ†é˜</span></div>
                            </div>
                            
                            <div className="bg-indigo-50 rounded-xl p-4 text-left border border-indigo-100 mb-6">
                                <div className="flex gap-2 items-center mb-2">
                                    <Brain className="text-indigo-600" size={18} />
                                    <h4 className="font-bold text-indigo-900 text-sm">è®Šå¼·å°çŸ¥è­˜</h4>
                                </div>
                                <p className="text-xs text-indigo-800 leading-relaxed">
                                    {playlist[0]?.science}
                                </p>
                            </div>

                            <button 
                                onClick={() => setGameState('dashboard')}
                                className="w-full bg-gray-900 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-gray-800 transition active:scale-95"
                            >
                                å›é¦–é 
                            </button>
                        </div>
                    </div>
                );
            }

            return <div>Loading...</div>;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
